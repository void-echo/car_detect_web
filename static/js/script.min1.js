!function(){const e=window.jQuery;class s{constructor(){const s=this;s.cache={},s.pendingAjax=!1,s.xhrAjaxSearch=!1,s.$body=e("body"),s.$window=e(window),s.$document=e(document),s.$preloader=e('<div class="docspress-preloader"><span><span></span></span></div>'),s.$singleAjax=e(".docspress-single-ajax"),s.initSearch(),s.initDocSearch(),s.initAnchors(),s.initFeedbacks(),s.initAjax()}stripHash(e){return e.replace(/#.*/,"")}initSearch(){const s=this;let n=!1;s.$document.on("submit",".docspress-search-form",(function(n){n.preventDefault(),s.prepareSearchResults(e(this))})),s.$document.on("input",".docspress-search-form",(function(o){o.preventDefault(),clearTimeout(n),n=setTimeout((()=>{s.prepareSearchResults(e(this))}),500)}))}prepareSearchResults(s){const n=this;if(n.xhrAjaxSearch&&n.xhrAjaxSearch.abort(),!s.find(".docspress-search-field").val())return s.next(".docspress-search-form-result").html(""),void s.removeClass("docspress-search-form-existence");n.xhrAjaxSearch=e.ajax({type:"GET",url:s.attr("action"),data:s.serialize(),success(o){const t=e(o).find(".docspress-search-list").get(0).outerHTML;s.next(".docspress-search-form-result").html(t),s.addClass("docspress-search-form-existence"),n.xhrAjaxSearch=!1},error(e){console.log(e),n.xhrAjaxSearch=!1}})}initDocSearch(){void 0!==window.docsearch&&e(".docspress-docsearch").each((function(){const s=e(this),n=s.attr("data-docsearch-app-id"),o=s.attr("data-docsearch-api-key"),t=s.attr("data-docsearch-index-name");n&&o&&t&&window.docsearch({appId:n,apiKey:o,indexName:t,container:this,debug:!1})}))}initAnchors(){const e=!!window.AnchorJS&&new window.AnchorJS;e&&(e.options={placement:"right",visible:"hover",icon:"#"},e.add(".docspress-single-content .entry-content h2, .docspress-single-content .entry-content h3, .docspress-single-content .entry-content h4"))}initFeedbacks(){const s=this;s.$body.on("click",".docspress-single-feedback a",(function(n){s.onFeedbackClick(n,e(this))})),s.$body.on("submit",".docspress-single-feedback + .docspress-single-feedback-suggestion",(function(n){s.onFeedbackSuggestionSend(n,e(this))}))}initAjax(){const e=this;e.$singleAjax.length&&(e.setCache(window.location.href,{href:window.location.href,title:document.title,doc:e.$singleAjax.html(),html:document.documentElement.outerHTML}),e.$singleAjax.on("click",".docspress-nav-list a, .docspress-single-breadcrumbs a, .docspress-single-articles a, .docspress-single-adjacent-nav a, .docspress-search-form-result a",(function(s){e.onDocLinksClick(s)})),e.$window.on("popstate",(function(s){e.renderDoc(s.target.location.href)})))}onFeedbackClick(s,n){s.preventDefault();const o=this;if(o.pendingAjax)return;o.pendingAjax=!0;const t=n.closest(".docspress-single-feedback").addClass("docspress-single-feedback-loading"),c=n.closest(".docspress-single-content").find(".docspress-single-feedback-suggestion"),a=n.data("type"),i={post_id:n.data("id"),type:a,action:"docspress_ajax_feedback",_wpnonce:window.docspress_vars.nonce};t.append(o.$preloader.clone()),e.post(window.docspress_vars.ajaxurl,i,(function(e){t.html("<div>".concat(e.data,"</div>")),e.success&&c.length&&(c.show(),c.append('<input type="hidden" name="feedback_type" value="'.concat(a,'">'))),t.removeClass("docspress-single-feedback-loading"),o.pendingAjax=!1}))}onFeedbackSuggestionSend(s,n){s.preventDefault();const o=this;if(o.pendingAjax)return;o.pendingAjax=!0;const t=n.closest(".docspress-single-feedback-suggestion").addClass("docspress-single-feedback-suggestion-loading"),c=n.find("button"),a=n.serializeArray().reduce(((e,s)=>(e[s.name]=s.value,e)),{}),i={post_id:a.id,from:a.from,suggestion:a.suggestion,feedback_type:a.feedback_type,action:"docspress_ajax_feedback_suggestion",_wpnonce:window.docspress_vars.nonce};t.append(o.$preloader.clone()),c.prop("disabled","disabled"),e.post(window.docspress_vars.ajaxurl,i,(function(e){t.html("<div>".concat(e.data,"</div>")).removeClass("docspress-single-feedback-suggestion-loading"),o.pendingAjax=!1}))}setCache(e,s){s=s||!1,(e=e||!1)&&s&&!this.cache[e]&&(this.cache[e]=s)}getCache(e){return!(!(e=e||!1)||!this.cache[e])&&this.cache[e]}renderDoc(s){const n=this.getCache(s);this.$singleAjax.html(n.doc),e("title").text(n.title),e(".wp-admin-bar-edit .ab-item").attr("href",s);const{top:o}=e(".docspress-single")[0].getBoundingClientRect();0>o&&this.$document.scrollTop(this.$document.scrollTop()+o),this.initAnchors(),this.$document.trigger("docspress_ajax_loaded",n)}onDocLinksClick(e){const s=e.currentTarget;1<e.which||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||window.location.protocol===s.protocol&&window.location.hostname===s.hostname&&(-1<s.href.indexOf("#")&&this.stripHash(s.href)===this.stripHash(window.location.href)||"file:"!==window.location.protocol&&(e.isDefaultPrevented()||(e.preventDefault(),this.loadDocPage(s.href))))}loadDocPage(s){const n=this;if(!(s=s||!1)||n.stripHash(s)===n.stripHash(window.location.href))return;const o=n.getCache(s);if(o)return n.renderDoc(s),void window.history.pushState(null,o.title,s);n.xhr&&n.xhr.abort&&(n.xhr.abort(),n.xhr={});const t=n.$singleAjax.addClass("docspress-single-ajax-loading");t.find(".docspress-single-content").append(n.$preloader.clone()),n.xhr=e.ajax({url:s,success:function(o){if(!o)return void(window.location=s);let c=e("<div>").html(o);const a=c.find("title:eq(0)").text()||document.title,i=c.find(".docspress-single-ajax").html();i?(n.setCache(s,{href:s,title:a,doc:i,html:o}),n.renderDoc(s),window.history.pushState(null,a,s),c.remove(),c=null,t.removeClass("docspress-single-ajax-loading")):window.location=s},error:function(e){0!==e.status?console.log("error",e):window.location=s,t.removeClass("docspress-single-ajax-loading")}})}}e((function(){new s}))}();